<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Space Shooter - Mobile Only</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
  background:#000;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  overflow:hidden;
  font-family:Arial, sans-serif;
  color:#fff;
}

#wrapper{
  position:relative;
}

canvas{
  background:radial-gradient(circle at top,#1a2440 0%,#000015 60%,#000 100%);
  border-radius:14px;
}

/* UI */
#info{
  position:absolute;
  top:5px;
  left:10px;
  right:10px;
  display:flex;
  justify-content:space-between;
  font-size:14px;
  text-shadow:0 0 6px #000;
  pointer-events:none;
}

#centerText{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  font-size:22px;
  text-align:center;
  text-shadow:0 0 10px #000;
}

/* Touch Buttons */
#controls{
  position:absolute;
  bottom:15px;
  left:0;
  width:100%;
  display:flex;
  justify-content:space-between;
}

.ctrl-btn{
  width:90px;
  height:90px;
  background:#ffffff20;
  border:2px solid #ffffff40;
  border-radius:50%;
  margin:0 10px;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:30px;
  color:#fff;
  user-select:none;
}

#fireBtn{
  width:100px;
  height:100px;
  background:#ff572240;
  border-color:#ff572280;
  font-size:40px;
}
</style>
</head>

<body>
<div id="wrapper">
  <canvas id="game" width="900" height="600"></canvas>

  <div id="info">
    <div id="scoreText">Score: 0</div>
    <div id="statusText">Wave: 1 | Fire: 1x | Lives: 5</div>
  </div>

  <div id="centerText">
    Tap ðŸ”¥ to Start<br>
    Mobile Controls Enabled
  </div>

  <div id="controls">
    <div id="leftBtn" class="ctrl-btn">â—€</div>
    <div id="fireBtn" class="ctrl-btn">ðŸ”¥</div>
    <div id="rightBtn" class="ctrl-btn">â–¶</div>
  </div>
</div>

<script>
/* ===============================
       CANVAS SETUP
================================*/
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const scoreText = document.getElementById("scoreText");
const statusText = document.getElementById("statusText");
const centerText = document.getElementById("centerText");

const W = canvas.width;
const H = canvas.height;

/* ===============================
       SHIP SETUP
================================*/
const ship = {
  x: W / 2,
  y: H - 80,
  w: 45,
  h: 55,
  speed: 350,
  fireLevel: 1,
  fireCooldown: 0,
  fireDelay: 220,
  lives: 5,
  alive: true
};

let bullets = [];
let asteroids = [];
let powerups = [];
let stars = [];

/* Background stars */
for (let i = 0; i < 160; i++) {
  stars.push({
    x: Math.random() * W,
    y: Math.random() * H,
    r: Math.random() * 1.3 + 0.4,
    s: Math.random() * 30 + 15
  });
}

let lastTime = 0;
let score = 0;
let wave = 1;

let difficultyTimer = 0;
let asteroidSpawnTimer = 0;
let asteroidSpawnInterval = 900;

let powerupSpawnTimer = 0;
let powerupSpawnInterval = 9000;

let gameRunning = false;

/* ===============================
        TOUCH CONTROL FLAGS
================================*/
let leftPressed = false;
let rightPressed = false;
let firePressed = false;

function bindTouch(btn, down, up) {
  btn.addEventListener("touchstart", e => {
    e.preventDefault(); down();
  });
  btn.addEventListener("touchend", e => {
    e.preventDefault(); up();
  });
}

bindTouch(document.getElementById("leftBtn"), () => leftPressed=true, () => leftPressed=false);
bindTouch(document.getElementById("rightBtn"), () => rightPressed=true, () => rightPressed=false);
bindTouch(document.getElementById("fireBtn"), () => firePressed=true, () => firePressed=false);

/* ===============================
          START GAME
================================*/
function startGame() {
  score = 0;
  wave = 1;
  difficultyTimer = 0;
  asteroidSpawnInterval = 900;

  asteroids = [];
  bullets = [];
  powerups = [];

  ship.x = W / 2;
  ship.fireLevel = 1;
  ship.fireCooldown = 0;
  ship.lives = 5;

  gameRunning = true;
  centerText.style.display = "none";

  lastTime = performance.now();
  requestAnimationFrame(loop);
}

/* Tap fire to start */
document.getElementById("fireBtn").addEventListener("click", () => {
  if (!gameRunning) startGame();
});

/* ===============================
            MAIN LOOP
================================*/
function loop(t) {
  if (!gameRunning) return;

  let dt = t - lastTime;
  lastTime = t;

  update(dt);
  draw();

  requestAnimationFrame(loop);
}

/* ===============================
            UPDATE
================================*/
function update(dt) {
  let sec = dt / 1000;

  /* Difficulty */
  difficultyTimer += dt;
  if (difficultyTimer > 12000) {
    difficultyTimer = 0;
    wave++;
    asteroidSpawnInterval = Math.max(300, asteroidSpawnInterval - 80);
  }

  /* Movement */
  let move = 0;
  if (leftPressed) move = -1;
  if (rightPressed) move = 1;

  ship.x += move * ship.speed * sec;
  ship.x = Math.max(ship.w/2, Math.min(W - ship.w/2, ship.x));

  /* Shooting */
  ship.fireCooldown -= dt;
  if (ship.fireCooldown < 0) ship.fireCooldown = 0;

  if (firePressed && ship.fireCooldown === 0) {
    shoot();
    ship.fireCooldown = ship.fireDelay;
  }

  /* Spawn asteroids */
  asteroidSpawnTimer += dt;
  if (asteroidSpawnTimer >= asteroidSpawnInterval) {
    asteroidSpawnTimer = 0;
    spawnAsteroid();
  }

  /* Spawn powerup */
  powerupSpawnTimer += dt;
  if (powerupSpawnTimer >= powerupSpawnInterval) {
    powerupSpawnTimer = 0;
    spawnPowerup();
  }

  /* Stars */
  stars.forEach(s => {
    s.y += s.s * sec * 0.1;
    if (s.y > H) {
      s.y = -5;
      s.x = Math.random() * W;
    }
  });

  /* Bullets */
  bullets.forEach(b => b.y += b.vy * sec);
  bullets = bullets.filter(b => b.y > -20);

  /* Asteroids */
  asteroids.forEach(a => {
    a.y += a.vy * sec;
    a.rotation += a.vrot * sec;
  });
  asteroids = asteroids.filter(a => a.y < H + 60);

  /* Powerups */
  powerups.forEach(p => p.y += p.vy * sec);
  powerups = powerups.filter(p => p.y < H + 30);

  handleBulletHits();
  handleShipHits();
  handlePowerupHits();

  scoreText.textContent = "Score: " + score;
  statusText.textContent = `Wave: ${wave} | Fire: ${ship.fireLevel}x | Lives: ${ship.lives}`;
}

/* ===============================
          DRAW THINGS
================================*/
function draw() {
  ctx.clearRect(0, 0, W, H);
  drawBackground();
  drawShip();
  drawBullets();
  drawAsteroids();
  drawPowerups();
}

function drawBackground() {
  let g = ctx.createRadialGradient(W/2,H/2,0,W/2,H/2,W/1.1);
  g.addColorStop(0,"rgba(40,80,180,0.35)");
  g.addColorStop(1,"rgba(0,0,0,0)");
  ctx.fillStyle = g;
  ctx.fillRect(0,0,W,H);

  stars.forEach(s=>{
    ctx.beginPath();
    ctx.globalAlpha = 0.5;
    ctx.fillStyle = "#fff";
    ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
    ctx.fill();
  });
}

function drawShip() {
  ctx.save();
  ctx.translate(ship.x, ship.y);

  /* Flame */
  ctx.beginPath();
  ctx.moveTo(-10, ship.h/2);
  ctx.lineTo(0, ship.h/2 + 22 + Math.random()*5);
  ctx.lineTo(10, ship.h/2);
  let fg = ctx.createLinearGradient(0,0,0,40);
  fg.addColorStop(0,"yellow");
  fg.addColorStop(1,"orange");
  ctx.fillStyle = fg;
  ctx.fill();

  /* Body */
  ctx.beginPath();
  ctx.moveTo(0,-ship.h/2);
  ctx.lineTo(-ship.w/2, ship.h/2);
  ctx.lineTo(ship.w/2, ship.h/2);
  ctx.closePath();
  ctx.fillStyle="#4eb6ff";
  ctx.fill();

  ctx.restore();
}

function drawBullets() {
  ctx.fillStyle="yellow";
  bullets.forEach(b=>{
    ctx.fillRect(b.x-2, b.y-12, 4, 16);
  });
}

/* Asteroids */
function drawAsteroids() {
  ctx.save();
  for (const a of asteroids) {
    ctx.translate(a.x, a.y);
    ctx.rotate(a.rotation);

    ctx.beginPath();
    if (a.type==="small") ctx.fillStyle="#b87333";
    else if (a.type==="medium") ctx.fillStyle="#777";
    else ctx.fillStyle="#442f1f";

    ctx.arc(0,0,a.r,0,Math.PI*2);
    ctx.fill();

    ctx.setTransform(1,0,0,1,0,0);
  }
  ctx.restore();
}

function drawPowerups() {
  ctx.fillStyle="cyan";
  powerups.forEach(p=>{
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fill();
  });
}

/* ===============================
          SPAWN OBJECTS
================================*/
function spawnAsteroid() {
  let rnd = Math.random();
  let type, r, speed;

  if (rnd < 0.45) {
    type="small";
    r=Math.random()*16+12;
    speed=230;
  } else if (rnd < 0.8) {
    type="medium";
    r=Math.random()*22+20;
    speed=170;
  } else {
    type="big";
    r=Math.random()*30+30;
    speed=140;
  }

  asteroids.push({
    x:Math.random()*(W-100)+50,
    y:-30,
    r,
    type,
    vy:speed + wave*18,
    rotation:0,
    vrot:(Math.random()*2-1)*1.2
  });
}

function spawnPowerup() {
  powerups.push({
    x:Math.random()*(W-80)+40,
    y:-30,
    r:16,
    vy:140
  });
}

function shoot() {
  let offs = {
    1:[0],
    2:[-14,14],
    3:[-18,0,18],
    4:[-22,-8,8,22]
  }[ship.fireLevel];

  offs.forEach(o=>{
    bullets.push({x:ship.x+o, y:ship.y-ship.h/2, vy:-520});
  });
}

/* ===============================
          COLLISIONS
================================*/
function rectCircleCollide(rx,ry,rw,rh,cx,cy,cr){
  let testX=Math.max(rx,Math.min(cx,rx+rw));
  let testY=Math.max(ry,Math.min(cy,ry+rh));
  let dx=cx-testX, dy=cy-testY;
  return dx*dx+dy*dy <= cr*cr;
}

function handleBulletHits() {
  for (let i=asteroids.length-1;i>=0;i--){
    for (let j=bullets.length-1;j>=0;j--){
      let a=asteroids[i], b=bullets[j];
      if(rectCircleCollide(b.x-2,b.y-12,4,16,a.x,a.y,a.r)){
        asteroids.splice(i,1);
        bullets.splice(j,1);
        score+=10;
        break;
      }
    }
  }
}

function handleShipHits() {
  for (let i=asteroids.length-1;i>=0;i--){
    let a=asteroids[i];
    if(rectCircleCollide(
      ship.x-ship.w/2,
      ship.y-ship.h/2,
      ship.w,ship.h,
      a.x,a.y,a.r
    )){
      asteroids.splice(i,1);
      ship.lives--;
      if(ship.lives<=0){ gameOver(); }
      return;
    }
  }
}

function handlePowerupHits() {
  for (let i=powerups.length-1;i>=0;i--){
    let p=powerups[i];
    if(rectCircleCollide(
      ship.x-ship.w/2,
      ship.y-ship.h/2,
      ship.w,ship.h,
      p.x,p.y,p.r
    )){
      powerups.splice(i,1);
      if(ship.fireLevel<4) ship.fireLevel++;
    }
  }
}

/* ===============================
            GAME OVER
================================*/
function gameOver() {
  gameRunning=false;
  centerText.style.display="block";
  centerText.innerHTML =
    "GAME OVER<br>Score: "+score+"<br><small>Tap ðŸ”¥ to Restart</small>";
}

/* Idle animation */
(function idle(){
  let last=performance.now();
  function frame(t){
    if(gameRunning)return;
    let dt=t-last; last=t;

    let sec=dt/1000;
    stars.forEach(s=>{
      s.y += s.s*sec*0.05;
      if(s.y>H){s.y=-5;s.x=Math.random()*W;}
    });

    ctx.clearRect(0,0,W,H);
    drawBackground();
    drawShip();

    requestAnimationFrame(frame);
  }
  requestAnimationFrame(frame);
})();
</script>

</body>
</html>
